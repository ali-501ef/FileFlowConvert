<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Universal to JPEG Converter - FileFlow | Convert Any File to JPEG</title>
    <meta name="description" content="Convert any file format to JPEG images. Supports PDF, HEIC, PNG, WEBP, AVIF, BMP and more. Smart conversion with preview.">
    <link rel="canonical" href="https://fileflow.com/convert-to-jpeg">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Universal to JPEG Converter - FileFlow">
    <meta property="og:description" content="Convert any file format to JPEG images. Supports PDF, HEIC, PNG, WEBP, AVIF, BMP and more.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://fileflow.com/convert-to-jpeg">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Styles -->
    <link rel="stylesheet" href="/styles.css">
    
    <!-- Navigation Script -->
    <script src="/js/navigation.js" defer></script>
    
    <!-- Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/heic2any@0.0.4/dist/heic2any.min.js"></script>
    <script>
        // Verify heic2any library is loaded
        window.addEventListener('load', function() {
            if (typeof heic2any === 'undefined') {
                console.warn('HEIC conversion library failed to load, attempting fallback...');
                // Fallback: try loading from alternative CDN
                const script = document.createElement('script');
                script.src = 'https://unpkg.com/heic2any@0.0.4/dist/heic2any.min.js';
                script.onload = () => console.log('HEIC library loaded from fallback CDN');
                script.onerror = () => console.error('HEIC library failed to load from all sources');
                document.head.appendChild(script);
            }
        });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@ffmpeg/ffmpeg@0.12.10/dist/umd/ffmpeg.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@ffmpeg/util@0.12.1/dist/umd/util.js"></script>
</head>
<body>
    <!-- Top AdSense Banner -->
    <div class="ad-placeholder ad-banner-top">
        <span class="ad-text">Advertisement Banner (728x90)</span>
    </div>

    <!-- Sticky Navigation Bar -->
    <nav class="sticky-nav">
        <div class="nav-container">
            <div class="nav-brand">
                <a href="/" data-testid="nav-brand">FileFlow</a>
            </div>
            
            <div class="nav-menu">
                <!-- Image Tools -->
                <div class="nav-dropdown">
                    <button class="nav-dropdown-trigger" data-testid="nav-image-trigger">
                        Image Tools
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                        </svg>
                    </button>
                    <div class="nav-dropdown-content">
                        <a href="/convert-to-jpeg.html" class="nav-dropdown-item" data-testid="nav-convert-jpeg">Convert to JPEG</a>
                        <a href="/heic-to-jpg.html" class="nav-dropdown-item" data-testid="nav-heic-jpg">HEIC to JPG</a>
                        <a href="/jpg-to-png.html" class="nav-dropdown-item" data-testid="nav-jpg-png">JPG to PNG</a>
                    </div>
                </div>

                <!-- PDF Tools -->
                <div class="nav-dropdown">
                    <button class="nav-dropdown-trigger" data-testid="nav-pdf-trigger">
                        PDF Tools
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                        </svg>
                    </button>
                    <div class="nav-dropdown-content">
                        <a href="/pdf-merge.html" class="nav-dropdown-item" data-testid="nav-pdf-merge">PDF Merge</a>
                        <a href="/pdf-split.html" class="nav-dropdown-item" data-testid="nav-pdf-split">PDF Split</a>
                        <a href="/pdf-compress.html" class="nav-dropdown-item" data-testid="nav-pdf-compress">PDF Compress</a>
                        <a href="/pdf-rotate.html" class="nav-dropdown-item" data-testid="nav-pdf-rotate">PDF Rotate</a>
                        <a href="/pdf-watermark.html" class="nav-dropdown-item" data-testid="nav-pdf-watermark">PDF Watermark</a>
                        <a href="/pdf-to-word.html" class="nav-dropdown-item" data-testid="nav-pdf-to-word">PDF to Word</a>
                    </div>
                </div>

                <!-- Audio/Video Tools -->
                <div class="nav-dropdown">
                    <button class="nav-dropdown-trigger" data-testid="nav-media-trigger">
                        Audio/Video Tools
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                        </svg>
                    </button>
                    <div class="nav-dropdown-content">
                        <a href="/mp4-to-mp3.html" class="nav-dropdown-item" data-testid="nav-mp4-mp3">MP4 to MP3</a>
                        <a href="/audio-converter.html" class="nav-dropdown-item" data-testid="nav-audio-convert">Audio Converter</a>
                        <a href="/video-compress.html" class="nav-dropdown-item" data-testid="nav-video-compress">Video Compress</a>
                        <a href="/gif-maker.html" class="nav-dropdown-item" data-testid="nav-gif-maker">GIF Maker</a>
                        <a href="/video-trim.html" class="nav-dropdown-item" data-testid="nav-video-trim">Video Trim</a>
                        <a href="/video-merger.html" class="nav-dropdown-item" data-testid="nav-video-merge">Video Merger</a>
                    </div>
                </div>
            </div>
            
            <button class="mobile-nav-toggle" data-testid="mobile-nav-toggle">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
                </svg>
            </button>
        </div>
    </nav>

    <div class="layout-wrapper">
        <!-- Desktop Sidebar Ad Left -->
        <div class="sidebar-ad desktop-only">
            <div class="ad-placeholder ad-sidebar">
                <span class="ad-text">Sidebar<br>Advertisement<br>(160x600)</span>
            </div>
        </div>

        <!-- Main Content -->
        <main class="main-content">
            <div class="container">
                <!-- Tool Header -->
                <div class="tool-header-section">
                    <nav class="breadcrumb">
                        <a href="/" class="breadcrumb-link" data-testid="link-back-home">‚Üê Back to Tools</a>
                    </nav>
                    <h1 class="tool-page-title">Universal to JPEG Converter</h1>
                    <p class="tool-page-description">Convert any file format to JPEG images. Supports PDF, HEIC, PNG, WEBP, AVIF, BMP and more.</p>
                </div>

                <!-- Upload Section -->
                <div class="tool-container">
                    <div id="upload-section" class="upload-section">
                        <div class="file-drop-zone" data-testid="drop-zone-universal" onclick="document.getElementById('file-input').click()">
                            <svg class="upload-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                            </svg>
                            <h3 class="upload-title">Drop any files here or click to upload</h3>
                            <p class="upload-instructions">Supports PDF, HEIC, PNG, WEBP, AVIF, BMP, video frames and more</p>
                        </div>
                        <input type="file" id="file-input" multiple class="file-input" accept="*/*" data-testid="input-universal-files">
                    </div>

                    <!-- Quality Settings -->
                    <div id="quality-settings" class="quality-settings hidden">
                        <h3 class="section-subtitle">JPEG Quality</h3>
                        <div class="quality-options">
                            <label class="quality-option">
                                <input type="radio" name="quality" value="0.7" data-testid="radio-quality-70">
                                <span class="quality-label">Standard (70%)</span>
                            </label>
                            <label class="quality-option">
                                <input type="radio" name="quality" value="0.85" checked data-testid="radio-quality-85">
                                <span class="quality-label">High (85%)</span>
                            </label>
                            <label class="quality-option">
                                <input type="radio" name="quality" value="0.95" data-testid="radio-quality-95">
                                <span class="quality-label">Maximum (95%)</span>
                            </label>
                        </div>
                    </div>

                    <!-- File List -->
                    <div id="file-list" class="file-list hidden">
                        <h3 class="section-subtitle">Selected Files</h3>
                        <div id="file-cards" class="file-cards">
                            <!-- File cards will be inserted here -->
                        </div>
                    </div>

                    <!-- Progress Section -->
                    <div id="progress-section" class="progress-section hidden">
                        <div class="progress-header">
                            <span class="progress-label">Converting to JPEG...</span>
                            <span id="progress-text" class="progress-text" data-testid="text-progress">0%</span>
                        </div>
                        <div class="progress-bar-container">
                            <div id="progress-bar" class="progress-bar" data-testid="progress-bar" style="width: 0%"></div>
                        </div>
                        <div id="conversion-status" class="ffmpeg-status" data-testid="text-conversion-status">
                            Analyzing files...
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div id="action-buttons" class="action-buttons hidden">
                        <button id="convert-btn" class="btn btn-primary" data-testid="button-convert">
                            Convert to JPEG
                        </button>
                        <button id="clear-btn" class="btn btn-secondary" data-testid="button-clear">
                            Clear All
                        </button>
                    </div>

                    <!-- Tool Information Section -->
                    <div class="tool-info-section">
                        <div class="info-grid">
                            <div class="info-card">
                                <div class="info-icon">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                                    </svg>
                                </div>
                                <h3>Universal Format</h3>
                                <p>Convert any file type to JPEG for maximum compatibility. Supports PDF pages, HEIC photos, PNG, WebP, AVIF, and even video frames.</p>
                            </div>
                            <div class="info-card">
                                <div class="info-icon">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
                                    </svg>
                                </div>
                                <h3>Optimized Size</h3>
                                <p>JPEG compression reduces file sizes significantly while maintaining good visual quality. Perfect for web use and storage optimization.</p>
                            </div>
                            <div class="info-card">
                                <div class="info-icon">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/>
                                        <rect x="8" y="2" width="8" height="4" rx="1" ry="1"/>
                                        <path d="M12 11h4"/>
                                        <path d="M12 16h4"/>
                                        <path d="M8 11h.01"/>
                                        <path d="M8 16h.01"/>
                                    </svg>
                                </div>
                                <h3>Batch Processing</h3>
                                <p>Convert multiple files simultaneously from different formats. Supports quality settings to balance file size and image quality.</p>
                            </div>
                        </div>
                        <div class="tool-benefits">
                            <h3>Why Use Universal JPEG Conversion?</h3>
                            <p>JPEG is the most widely supported image format across all devices, browsers, and applications. Converting various file types to JPEG ensures compatibility everywhere while reducing file sizes for faster loading and easier sharing. This universal converter handles formats that other tools cannot, making it essential for comprehensive file management.</p>
                        </div>
                    </div>

                    <!-- Preview and Download Section -->
                    <div id="download-section" class="download-section hidden">
                        <div class="success-message">
                            <div class="success-header">
                                <svg class="success-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                                <h3 class="success-title">Conversion Complete!</h3>
                            </div>
                            <p class="success-text">Your files have been successfully converted to JPEG.</p>
                            <div id="preview-container" class="preview-container" data-testid="preview-container">
                                <!-- Preview images will be inserted here -->
                            </div>
                            <div id="download-links" class="download-links" data-testid="download-links">
                                <!-- Download links will be inserted here -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tool Information -->
                <div class="tool-info-section">
                    <h3 class="info-title">How it works</h3>
                    <div class="info-content">
                        <ul class="info-list">
                            <li>Converts PDF first page, HEIC photos, PNG/WEBP/AVIF images to JPEG</li>
                            <li>Extracts first frame from video files as JPEG images</li>
                            <li>Smart format detection and optimal conversion method</li>
                            <li>Preview results before downloading</li>
                            <li>Files are processed securely and deleted automatically after conversion</li>
                        </ul>
                    </div>
                </div>
            </div>
        </main>

        <!-- Desktop Sidebar Ad Right -->
        <div class="sidebar-ad desktop-only">
            <div class="ad-placeholder ad-sidebar">
                <span class="ad-text">Sidebar<br>Advertisement<br>(160x600)</span>
            </div>
        </div>
    </div>

    <!-- Bottom AdSense Banner -->
    <div class="ad-placeholder ad-banner-bottom">
        <span class="ad-text">Advertisement Banner (728x90)</span>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3 class="footer-title">FileFlow</h3>
                    <p class="footer-description">Professional file conversion tools for everyone.</p>
                </div>
                <div class="footer-section">
                    <h4 class="footer-subtitle">Related Tools</h4>
                    <ul class="footer-links">
                        <li><a href="/heic-to-jpg.html" class="footer-link">HEIC to JPG</a></li>
                        <li><a href="/jpg-to-png.html" class="footer-link">JPG to PNG</a></li>
                        <li><a href="/pdf-merge.html" class="footer-link">PDF Merge</a></li>
                        <li><a href="/mp4-to-mp3.html" class="footer-link">MP4 to MP3</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 FileFlow. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="/js/main.js"></script>
    <!-- Universal to JPEG Tool - Use server-side converter -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const dropZone = document.querySelector('.file-drop-zone');
            const fileInput = document.getElementById('file-input');
            const convertBtn = document.getElementById('convert-btn');
            
            dropZone.addEventListener('click', () => fileInput.click());
            
            fileInput.addEventListener('change', function(e) {
                const files = Array.from(e.target.files);
                if (files.length > 0) {
                    document.getElementById('file-list').classList.remove('hidden');
                    document.getElementById('quality-settings').classList.remove('hidden');
                    document.getElementById('action-buttons').classList.remove('hidden');
                    
                    const fileCards = document.getElementById('file-cards');
                    fileCards.innerHTML = files.map(file => `
                        <div class="file-card">
                            <div class="file-info">
                                <div class="file-name">${file.name}</div>
                                <div class="file-size">${Math.round(file.size/1024)}KB</div>
                            </div>
                        </div>
                    `).join('');
                    
                    convertBtn.disabled = false;
                }
            });
            
            convertBtn.addEventListener('click', async function() {
                const files = fileInput.files;
                if (files.length === 0) return;
                
                convertBtn.textContent = 'Converting...';
                convertBtn.disabled = true;
                document.getElementById('progress-section').classList.remove('hidden');
                
                try {
                    for (let i = 0; i < files.length; i++) {
                        const file = files[i];
                        const progress = Math.round(((i + 1) / files.length) * 100);
                        document.getElementById('progress-text').textContent = progress + '%';
                        document.getElementById('progress-bar').style.width = progress + '%';
                        
                        // Upload and convert
                        const formData = new FormData();
                        formData.append('file', file);
                        
                        const uploadResponse = await fetch('/api/upload', { method: 'POST', body: formData });
                        const uploadResult = await uploadResponse.json();
                        
                        if (!uploadResult.success) throw new Error('Upload failed');
                        
                        const convertResponse = await fetch('/api/convert', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                file_id: uploadResult.file_id,
                                output_format: 'jpg',
                                temp_path: uploadResult.temp_path
                            })
                        });
                        
                        const convertResult = await convertResponse.json();
                        
                        if (convertResult.success) {
                            const link = document.createElement('a');
                            link.href = convertResult.download_url;
                            link.download = convertResult.output_file;
                            document.body.appendChild(link);
                            link.click();
                            document.body.removeChild(link);
                        } else {
                            throw new Error(convertResult.error || 'Conversion failed');
                        }
                    }
                    
                    document.getElementById('download-section').classList.remove('hidden');
                    
                } catch (error) {
                    console.error('Conversion error:', error);
                    alert('Conversion failed: ' + error.message);
                } finally {
                    convertBtn.textContent = 'Convert to JPEG';
                    convertBtn.disabled = false;
                }
            });
        });
    </script>
</body>
</html>