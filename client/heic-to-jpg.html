<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HEIC to JPG Converter - FileFlow | Convert iPhone Photos</title>
    <meta name="description" content="Convert HEIC photos to JPG format instantly. Batch conversion of iPhone photos with quality preservation. Free online HEIC to JPG converter.">
    <link rel="canonical" href="https://fileflow.com/heic-to-jpg">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="HEIC to JPG Converter - FileFlow">
    <meta property="og:description" content="Convert HEIC photos to JPG format instantly. Batch conversion with quality preservation.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://fileflow.com/heic-to-jpg">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Styles -->
    <link rel="stylesheet" href="/styles.css">
    
    <!-- Navigation Script -->
    <script src="/js/navigation.js" defer></script>
    
    <!-- HEIC2ANY Library - Try alternative version for better compatibility -->
    <script src="https://cdn.jsdelivr.net/npm/heic2any@0.0.4/dist/heic2any.min.js"></script>
    <script>
        // Fallback loader for heic2any with better error handling
        window.addEventListener('load', function() {
            if (typeof heic2any === 'undefined') {
                console.warn('Primary HEIC library failed to load, attempting fallback...');
                const fallbackScript = document.createElement('script');
                fallbackScript.src = 'https://unpkg.com/heic2any@0.0.4/dist/heic2any.min.js';
                document.head.appendChild(fallbackScript);
            }
        });
    </script>
</head>
<body>
    <!-- Top AdSense Banner -->
    <div class="ad-placeholder ad-banner-top">
        <span class="ad-text">Advertisement Banner (728x90)</span>
    </div>

    <!-- Sticky Navigation Bar -->
    <nav class="sticky-nav">
        <div class="nav-container">
            <div class="nav-brand">
                <a href="/" data-testid="nav-brand">FileFlow</a>
            </div>
            
            <div class="nav-menu">
                <!-- Image Tools -->
                <div class="nav-dropdown">
                    <button class="nav-dropdown-trigger" data-testid="nav-image-trigger">
                        Image Tools
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                        </svg>
                    </button>
                    <div class="nav-dropdown-content">
                        <a href="/convert-to-jpeg.html" class="nav-dropdown-item" data-testid="nav-convert-jpeg">Convert to JPEG</a>
                        <a href="/heic-to-jpg.html" class="nav-dropdown-item" data-testid="nav-heic-jpg">HEIC to JPG</a>
                        <a href="/jpg-to-png.html" class="nav-dropdown-item" data-testid="nav-jpg-png">JPG to PNG</a>
                    </div>
                </div>

                <!-- PDF Tools -->
                <div class="nav-dropdown">
                    <button class="nav-dropdown-trigger" data-testid="nav-pdf-trigger">
                        PDF Tools
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                        </svg>
                    </button>
                    <div class="nav-dropdown-content">
                        <a href="/pdf-merge.html" class="nav-dropdown-item" data-testid="nav-pdf-merge">PDF Merge</a>
                        <a href="/pdf-split.html" class="nav-dropdown-item" data-testid="nav-pdf-split">PDF Split</a>
                        <a href="/pdf-compress.html" class="nav-dropdown-item" data-testid="nav-pdf-compress">PDF Compress</a>
                        <a href="/pdf-rotate.html" class="nav-dropdown-item" data-testid="nav-pdf-rotate">PDF Rotate</a>
                        <a href="/pdf-watermark.html" class="nav-dropdown-item" data-testid="nav-pdf-watermark">PDF Watermark</a>
                        <a href="/pdf-to-word.html" class="nav-dropdown-item" data-testid="nav-pdf-to-word">PDF to Word</a>
                    </div>
                </div>

                <!-- Audio/Video Tools -->
                <div class="nav-dropdown">
                    <button class="nav-dropdown-trigger" data-testid="nav-media-trigger">
                        Audio/Video Tools
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                        </svg>
                    </button>
                    <div class="nav-dropdown-content">
                        <a href="/mp4-to-mp3.html" class="nav-dropdown-item" data-testid="nav-mp4-mp3">MP4 to MP3</a>
                        <a href="/audio-converter.html" class="nav-dropdown-item" data-testid="nav-audio-convert">Audio Converter</a>
                        <a href="/video-compress.html" class="nav-dropdown-item" data-testid="nav-video-compress">Video Compress</a>
                        <a href="/gif-maker.html" class="nav-dropdown-item" data-testid="nav-gif-maker">GIF Maker</a>
                        <a href="/video-trim.html" class="nav-dropdown-item" data-testid="nav-video-trim">Video Trim</a>
                        <a href="/video-merger.html" class="nav-dropdown-item" data-testid="nav-video-merge">Video Merger</a>
                    </div>
                </div>
            </div>
            
            <button class="mobile-nav-toggle" data-testid="mobile-nav-toggle">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
                </svg>
            </button>
        </div>
    </nav>

    <div class="layout-wrapper">
        <!-- Desktop Sidebar Ad Left -->
        <div class="sidebar-ad desktop-only">
            <div class="ad-placeholder ad-sidebar">
                <span class="ad-text">Sidebar<br>Advertisement<br>(160x600)</span>
            </div>
        </div>

        <!-- Main Content -->
        <main class="main-content">
            <div class="container">
                <!-- Tool Header -->
                <div class="tool-header-section">
                    <nav class="breadcrumb">
                        <a href="/" class="breadcrumb-link" data-testid="link-back-home">‚Üê Back to Tools</a>
                    </nav>
                    <h1 class="tool-page-title">HEIC to JPG Converter</h1>
                    <p class="tool-page-description">Convert iPhone HEIC photos to universal JPG format while maintaining quality.</p>
                </div>

                <!-- Upload Section -->
                <div class="tool-container">
                    <div id="upload-section" class="upload-section">
                        <div class="upload-area" id="heic-drop-zone" data-testid="drop-zone-heic" onclick="document.getElementById('heic-file-input').click()">
                            <div class="upload-icon">
                                <svg width="64" height="64" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                                </svg>
                            </div>
                            <h3>Drop HEIC files here</h3>
                            <p>or click anywhere to select files</p>
                            <p class="supported-formats">Supports HEIC, HEIF files from iPhone/iPad</p>
                            <input type="file" id="heic-file-input" accept=".heic,.heif,image/*" hidden data-testid="input-heic-files">
                        </div>
                        <div class="converter-controls">
                            <select id="heic-format-select" class="format-select" data-testid="select-output-format">
                                <option value="jpg">JPG</option>
                                <option value="png">PNG</option>
                                <option value="webp">WebP</option>
                            </select>
                            <button id="heic-convert-btn" class="btn btn-primary btn-large" data-testid="button-convert-now">
                                <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                                </svg>
                                Convert Now
                            </button>
                        </div>
                    </div>

                    <!-- File Preview (will be populated by JavaScript) -->
                </div>

                <!-- Tool Information -->
                <div class="tool-info-section">
                    <h3 class="info-title">How it works</h3>
                    <div class="info-content">
                        <ul class="info-list">
                            <li>Converts Apple HEIC photos to widely-supported JPG format</li>
                            <li>Maintains original image quality and metadata</li>
                            <li>Supports batch conversion of multiple files</li>
                            <li>Secure server-side processing with automatic cleanup</li>
                        </ul>
                    </div>
                </div>
            </div>
        </main>

        <!-- Desktop Sidebar Ad Right -->
        <div class="sidebar-ad desktop-only">
            <div class="ad-placeholder ad-sidebar">
                <span class="ad-text">Sidebar<br>Advertisement<br>(160x600)</span>
            </div>
        </div>
    </div>

    <!-- Bottom AdSense Banner -->
    <div class="ad-placeholder ad-banner-bottom">
        <span class="ad-text">Advertisement Banner (728x90)</span>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3 class="footer-title">FileFlow</h3>
                    <p class="footer-description">Professional file conversion tools for everyone.</p>
                </div>
                <div class="footer-section">
                    <h4 class="footer-subtitle">Related Tools</h4>
                    <ul class="footer-links">
                        <li><a href="/jpg-to-png.html" class="footer-link">JPG to PNG</a></li>
                        <li><a href="/pdf-merge.html" class="footer-link">PDF Merge</a></li>
                        <li><a href="/mp4-to-mp3.html" class="footer-link">MP4 to MP3</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 FileFlow. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="/js/main.js"></script>
    <!-- HEIC Tool - Simple click handler for file upload -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const dropZone = document.getElementById('heic-drop-zone');
            const fileInput = document.getElementById('heic-file-input');
            const formatSelect = document.getElementById('heic-format-select');
            const convertBtn = document.getElementById('heic-convert-btn');
            
            // Click handler for drop zone
            dropZone.addEventListener('click', function() {
                fileInput.click();
            });
            
            // File selection handler
            fileInput.addEventListener('change', function(e) {
                const files = Array.from(e.target.files);
                if (files.length > 0) {
                    // Show file info and enable convert button
                    const file = files[0];
                    console.log('File selected:', file.name);
                    
                    // Update UI to show file is ready
                    dropZone.innerHTML = `
                        <div class="drop-zone-content">
                            <div class="upload-icon">
                                <svg width="48" height="48" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                            </div>
                            <h3 class="drop-zone-text">File Ready: ${file.name}</h3>
                            <p class="drop-zone-subtext">Click "Convert Now" to process</p>
                        </div>
                    `;
                    convertBtn.disabled = false;
                    convertBtn.style.opacity = '1';
                }
            });
            
            // Convert button handler
            convertBtn.addEventListener('click', async function() {
                const files = fileInput.files;
                if (files.length === 0) return;
                
                const file = files[0];
                const outputFormat = formatSelect.value;
                
                convertBtn.textContent = 'Converting...';
                convertBtn.disabled = true;
                
                try {
                    // Upload file
                    const formData = new FormData();
                    formData.append('file', file);
                    
                    const uploadResponse = await fetch('/api/upload', {
                        method: 'POST',
                        body: formData
                    });
                    
                    const uploadResult = await uploadResponse.json();
                    
                    if (!uploadResult.success) {
                        throw new Error('Upload failed');
                    }
                    
                    // Convert file
                    const convertResponse = await fetch('/api/convert', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            file_id: uploadResult.file_id,
                            output_format: outputFormat,
                            temp_path: uploadResult.temp_path
                        })
                    });
                    
                    const convertResult = await convertResponse.json();
                    
                    if (convertResult.success) {
                        // Show download link
                        dropZone.innerHTML = `
                            <div class="drop-zone-content">
                                <div class="upload-icon">
                                    <svg width="48" height="48" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
                                    </svg>
                                </div>
                                <h3 class="drop-zone-text">Conversion Complete!</h3>
                                <p class="drop-zone-subtext">
                                    <a href="${convertResult.download_url}" download class="download-link" style="color: #007AFF; text-decoration: underline;">
                                        Download ${outputFormat.toUpperCase()} (${Math.round(convertResult.file_size/1024)}KB)
                                    </a>
                                </p>
                            </div>
                        `;
                        
                        // Auto-download
                        const downloadLink = document.createElement('a');
                        downloadLink.href = convertResult.download_url;
                        downloadLink.download = convertResult.output_file;
                        document.body.appendChild(downloadLink);
                        downloadLink.click();
                        document.body.removeChild(downloadLink);
                        
                    } else {
                        throw new Error(convertResult.error || 'Conversion failed');
                    }
                    
                } catch (error) {
                    console.error('Conversion error:', error);
                    dropZone.innerHTML = `
                        <div class="drop-zone-content">
                            <div class="upload-icon">
                                <svg width="48" height="48" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                            </div>
                            <h3 class="drop-zone-text">Conversion Failed</h3>
                            <p class="drop-zone-subtext" style="color: #FF3B30;">${error.message}</p>
                        </div>
                    `;
                } finally {
                    convertBtn.textContent = 'Convert Now';
                    convertBtn.disabled = false;
                }
            });
        });
    </script>
</body>
</html>
